<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TurtleBot Imagens</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/eventemitter2@6.4.9/lib/eventemitter2.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/roslib@1/build/roslib.min.js"></script>

    <script type="text/javascript">
    var ros = new ROSLIB.Ros({
        url: 'ws://localhost:9090'
    });

    ros.on('connection', function() {
        console.log('Connected to websocket server.');
    });

    ros.on('error', function(error) {
        console.log('Error connecting to websocket server: ', error);
    });

    ros.on('close', function() {
        console.log('Connection to websocket server closed.');
    });

    var videoTopic = new ROSLIB.Topic({
        ros: ros,
        name: '/video_frames',
        messageType: 'sensor_msgs/CompressedImage'
    });

    videoTopic.subscribe(function(message) {
        var img = document.getElementById('videoStream');
        img.src = "data:image/jpeg;base64," + message.data;
    });

    var fpsTopic = new ROSLIB.Topic({
        ros: ros,
        name: '/fps',
        messageType: 'std_msgs/String'
    });

    fpsTopic.subscribe(function(message) {
        var fpsDisplay = document.getElementById('fpsDisplay');
        fpsDisplay.innerText = message.data;
    });
    </script>
</head>
<body>
    <div class="titulo">
        <h1>TurtleBot Teleoperado com Imagens</h1>
    </div>
    <div class="video">
        <img id="videoStream" alt="Video Stream" style="width: 640px; height: 400px;" />
    </div>
    <div class="status">
        <p>Latência: </p> <!-- valor de latência-->
        <p></p>
    </div>
    <div class="botoes-movimentacao">
        <button>Seta Direita</button>
        <button>Seta Baixo</button>
        <button>Seta Esquerda</button>
        <button>Seta Cima</button>
    </div>
</body>
</html>
